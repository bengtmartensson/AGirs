<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AGirs: AGirs (formerly ArduinoGirs)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AGirs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">AGirs (formerly ArduinoGirs) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a>This project implements a <a href="http://www.harctoolbox.org/Girs.html">Girs server</a> for the Arduino. That is, it is an interactive server that can send and receive IR signals, with some bells and whistles. The interactive server is mainly meant for interact with other programs. communicating over a serial line (likely in USB disguise), or TCP-sockets.</p>
<p>It is build on top of the low-level library called <a href="https://github.com/bengtmartensson/Infrared4Arduino">Infrared4Arduino</a>.</p>
<p>The main content of the project is an applications, <em>Girs</em> (including the "light" version <em>GirsLite</em>), which constitutes the server. There is also another application, <em>Listener</em>, which is a uni-directional program that just emits decodes on the serial interface. (It can for example to be used in conjunction with my Java program <a href="https://github.com/bengtmartensson/dispatcher">dispatcher</a>). Finally, there is a IR-to-serial demonstration program; an IR to serial converter (<em>Opponator</em>). These application are found as subdirectories of the directory <code>examples</code>. The subdirectory <code>src</code> contains a fairly small amount of supporting functionality, forming a library in the traditional Arduino sense.</p>
<p>This slighty unlogical organization is due to the wish to be compatible with the current <a href="https://github.com/arduino/Arduino/wiki/Arduino-IDE-1.5:-Library-specification">Arduino library specification</a>, required/desired for inclusion in the Arduino library manager. (There is presently no "Arduino application manager".)</p>
<p>For compilation with the Arduino IDE, the library <a href="https://github.com/bengtmartensson/Infrared4Arduino">Infrared4Arduino</a> should be installed with the Arduino library manager.</p>
<h1>Configuration files</h1>
<p>It is a modular program that is heavily based on CPP symbols, defined in the configuration file <code><a class="el" href="Girs_2config_8h.html" title="User configuration file.">examples/Girs/config.h</a></code>. This determines the capacities of the compiled program, and adapts the configuration to the underlying hardware. The options are (somewhat) documented in <code><a class="el" href="GirsFat_8config_8h.html" title="Complete configuration options.">examples/Girs/GirsFat.config.h</a></code>. Not all combination are sensible or implemented. Some, but not all, of the non-sensible combinations will be detected and will generate a compilation error.</p>
<p>If the preprocessor symbol <code>LCD</code> is defined in <code><a class="el" href="LedLcdManager_8cpp.html">src/GirsLib/LedLcdManager.cpp</a></code> (which is the default, except for the Arduino Micro), the library is configured with support for the LCD display, regardless of the settings in <code>config.h</code>.</p>
<h1>Modules and interactive commands</h1>
<h2>General</h2>
<p>The program takes commands from its input stream, and write responses on its output stream. The general concept is presented <a href="http://www.harctoolbox.org/Girs.html">here</a>. A command input consists of one single line, terminated with a carrage return (binary 0x0d). Output is also presented as a single line, terminated with a carrage return. Needless to say, these lines can be long. On a successful execution, typically "OK" is returned.</p>
<p>The communication can take place with another program or with a human using a version of a serial terminal. The command names can, in this implementation, be shortened as long as they are unique. Generally speaking, error handling and plausibility checking are presently basically non-existent...</p>
<p>The program runs in a single thread, with no multitasking whatsoever. Also, even in the Ethernet version, only one concurrent session is supported.</p>
<h2><a href="http://www.harctoolbox.org/Girs.html#Base">Base commands</a></h2>
<p>These commands are always present in a Girs server. They correspond to the <code>Base</code> module. </p><h3>version</h3>
<p><em>Input</em>: <code>version</code></p>
<p><em>Output</em>: The program name followed by the version string. Example: <code>AGirs 1.0.0</code>.</p>
<h3>modules</h3>
<p><em>Input</em>: <code>modules</code></p>
<p><em>Output</em>: Returns list of implemented modules, separated by whitespace. Example: <code>Base Transmit Capture Renderer Receive Decoder Led Lcd Parameters</code>.</p>
<p>Comment: A communicating peer evaluates this, in order to find out the capabilities of the Girs implementation. Both IrScrutinizer and the Lirc Girs driver do this, and adjust their behavior accordingly.</p>
<h2><a href="http://www.harctoolbox.org/Girs.html#NamedRemotes">NamedRemotes</a></h2>
<p>Presently not implemented, but is <a href="https://github.com/bengtmartensson/AGirs/issues/37">planned</a>.</p>
<h2><a href="http://www.harctoolbox.org/Girs.html#Transmit">Transmit</a></h2>
<p>Supported if the CPP symbol <code>TRANSMIT</code> is defined in the configuration. </p><h3>transmit</h3>
<p><em>Input</em>: <code>send &lt;no_sends&gt; &lt;frequency&gt; &lt;length_intro&gt; &lt;length_repeat&gt; &lt;durations...&gt;</code></p>
<p><em>Output</em>: <code>OK</code></p>
<p>Semantics:</p><ul>
<li><code>&lt;no_sends&gt;</code> denotes the number of times to send the signal.</li>
<li><code>&lt;frequency&gt;</code> denotes the modulation frequency in Hz (not kHz as in some other programs!). The value 0 is treated as "no modulaton", and sent to a non-modulating sender, if configured.</li>
<li><code>&lt;length_intro&gt;</code> denotes how many of the numbers supplied as <code>&lt;durations...&gt;</code> are to be considered as belonging to the intro sequence,</li>
<li><code>&lt;length_repeat&gt;</code> denotes how many of the numbers supplied as <code>&lt;durations...&gt;</code> are be considered as belonging to the repeat sequence (following the intro sequence durations),</li>
<li><code>&lt;length_ending&gt;</code> (normally 0) denotes how many of the numbers supplied as <code>&lt;durations...&gt;</code> are to be considered as belonging to the ending sequence, following after the repeat durations,</li>
<li><code>&lt;durations&gt;</code> the durations in micro seconds, making up the intro-, repeat-, and ending sequence, according to the preceding parameters.</li>
</ul>
<p>The intro sequence is always sent exactly one. If it is empty, the repeat sequence is sent <code>&lt;no_sends&gt;</code> times, otherwise <code>&lt;no_sends&gt;</code> - 1 times. Finally, the (normally empty) ending sequence is sent once.</p>
<h2><a href="http://www.harctoolbox.org/Girs.html#Capture">Capture</a></h2>
<p>Available if configured with the <code>CAPTURE</code> option.</p>
<p><em>Input</em>: <code>analyze</code> or <code>capture</code></p>
<p><em>Output</em> (Normal): <code>f=&lt;frequency&gt; &lt;durations with signs...&gt;</code></p>
<p><em>Output</em> (Timeout): <code>.</code></p>
<p>Semantics:</p><ul>
<li><code>&lt;frequency&gt;</code> is the measured modulation frequency.</li>
<li><code>&lt;durations with signs...&gt;</code> the measured durations in micro seconds; flashes with "+", gaps as "-".</li>
</ul>
<h2><a href="http://www.harctoolbox.org/Girs.html#Receive">Receive</a></h2>
<p>Available if configured with the <code>RECEIVE</code> option.</p>
<p><em>Input</em>: <code>receive</code></p>
<p><em>Output</em> (Normal): `&lt;durations with signs...&gt;</p>
<p><em>Output</em> (Timeout): <code>.</code></p>
<p>Semantics:</p><ul>
<li><code>&lt;durations with signs...&gt;</code> the measured durations in micro seconds; flashes with "+", gaps as "-".</li>
</ul>
<h2>Render</h2>
<p>Available if configured with the RENDER option.</p>
<p><em>Input</em>: <code>transmit &lt;no_sends&gt; &lt;protocol&gt; &lt;protocol_parameters&gt;</code></p>
<p><em>Output</em> (normal): <code>OK</code></p>
<p><em>Output</em> (Syntax error): <code>&lt;error message&gt;</code></p>
<p>Semantics:</p><ul>
<li><code>&lt;no_sends&gt;</code> number of times to send signal</li>
<li><code>&lt;protocol_name&gt;</code> name of protocol, presently <code>NEC1</code> and <code>RC5</code>-</li>
<li><code>&lt;protocol_parameters&gt;</code> protocol parameters, dependent on protocol.</li>
</ul>
<p><em>Example</em>: <code>transmit 1 rc5 0 12</code>. This turns on or off most Philips TVs.</p>
<h2>Decoder</h2>
<p>Available if configured with the <code>DECODER</code> option. No additional interactive commands, instead the <code>receive</code>-d commands are attempted to be decoded, and optionally display on an LCD display.</p>
<h2>LED</h2>
<p>Available if configured with the <code>LED</code> option.</p>
<p><em>Input</em>: <code>led &lt;logical_led_nr&gt; on|off|blink</code></p>
<p><em>Output</em>: <code>OK</code>.</p>
<p>Turns on/off/blinks the LED with the given logical number.</p>
<h2>LCD</h2>
<p>Available if configured with the <code>LCD</code> option.</p>
<p><em>Input</em>: <code>lcd &lt;message&gt;</code></p>
<p><em>Output</em>: <code>OK</code></p>
<p>Shows the message <code>&lt;message&gt;</code> on a connected LCD display for a certain time.</p>
<h2>Parameters</h2>
<p>Available if configured with the <code>PARAMETERS</code> option. The allows to inspect and to change some parameters.</p>
<p><em>Input</em>: <code>parameter &lt;parameter_name&gt; [&lt;parameter_value&gt;]</code></p>
<p><em>Output:</em> <code>&lt;parameter_name&gt;=&lt;parameter_value&gt;</code></p>
<p>Semantics: If <code>&lt;parameter_value&gt;</code> is given, the value is assigned to the named parameter, if possible. If not given, the present value is reported.</p>
<h3>Named of available adjustable parameters:</h3>
<p>The adjustable parameters depend on the configuration options. A few of these are listed next.</p>
<ul>
<li><code>beginTimeout</code>: time in milliseconds until timeout by not detected signal</li>
<li><code>captureEndingTimeout</code>: time in milliseconds for capture ending marking end of signal</li>
<li><code>receiveEndingTimeout</code>: time in milliseconds for receive ending marking end of signal</li>
<li><code>captureSize</code>: size, in number of durations, of captured (received) signals. Must be even.</li>
</ul>
<h2>Pronto</h2>
<p>Available if configured with the <code>PRONTO</code> option.</p>
<p><em>Input</em>: <code>hex &lt;no_sends&gt; &lt;pronto_hex_signal&gt;</code></p>
<p><em>Output</em>: <code>OK</code>.</p>
<p>Semantics:</p><ul>
<li><code>&lt;no_sends&gt;</code> number of times to send signal</li>
<li><code>&lt;pronto_hex_signal&gt;</code> Pronto hex form IR signal. Always start with <code>0000</code>.</li>
</ul>
<p>Sends the given signal the requested number of times.</p>
<h2>Info</h2>
<p>Available if configured with the option <code>INFO</code>.</p>
<p><em>Input</em>: info</p>
<p><em>Output</em>: Information on current platform; for example <code>Board: Arduino Mega2560, CPU frequency: 16000000L</code></p>
<h2>Memory</h2>
<p>Available if configured with the option <code>FREEMEM</code>.</p>
<p><em>Input</em>: memory</p>
<p><em>Output</em>: number of free bytes.</p>
<h2>Ethernet support</h2>
<p>If using an Ethernet shield with W5500 or W5200 chip, be sure that the Ethernet library version 2.0.0 or later is used, since it supports all W5*00 chips, auto-detecting during runtime.</p>
<p>This applies both to the Girs application as well as to the Listener.</p>
<h1>Hardware configuration</h1>
<p>I have written a <a href="http://www.harctoolbox.org/arduino_nano.html">fairly detailed description</a> of using an Arduino Nano (clone) by soldering suitable components to the PCB. This is a small handy gadget at the size of a (large) stamp and the price of a (small) pizza, perfect for using with IrScrutinizer and Lirc.</p>
<p>The hardware configuration is determined by including a suitable header file. It describes the attach sensor(s) and the pins they are connected to. To allow soldering sensors directly to the holes in some boards, the program supports defining e.g. <code>SENSOR_GND</code> and <code>SENSOR_VCC</code>, which will make the program define these pins as digital outputs, being fed by constant 0 and 5 volts (3.3 Volts on a 3.3 Volt board) respectively.</p>
<p>Note that the sending pin and the capture pin (as opposed to the receive pin) are not configurable, but has to follow the following table:</p>
<pre>
                          Sender Pin      Capture Pin
Uno/Nano (ATmega328P)          3             8
Leonardo/Micro (ATmega32U4)    9             4
Mega2560 (ATmega2560)          9            49
</pre><p>#</p><h1>Sending non-modulated signals.</h1>
<p>RF signals (433 MHz and other carrier frequencies) do not use the IR typical modulation. Also there are a few IR protocols (like <a href="http://www.hifi-remote.com/forums/viewtopic.php?t=14186&amp;start=40">Revox, Barco, Archer</a>) not using modulation. These signals can be sent by defining the symbol <code>NON_MOD</code>, and connecting some hardware capable of sending non-modulated signals (IR- <em>or</em> RF-) to the GPIO pin defined as <code>NON_MOD_PIN</code>. Then transmitted signals having frequency 0 will be directed to that device. (Later versions may use different syntax and semantic.)</p>
<h2>Testing</h2>
<p>The flashed unit can be tested with a standard terminal program, like the serial monitor of the Arduino IDE. For this, set the baud rate to 115200, and the line ending to carriage return. It is now possible to communicate with the unit using the <a href="http://www.harctoolbox.org/Girs.html">commands of Girs</a>. Just type the command to the program, and the unit will respond. Exactly which commands are available depends on the configuration. In all cases, the <code>version</code> and the <code>modules</code> commands are available. If <code>receive</code> is implemented, just type "`r`" (without the quotes), followed by return, and fire a suitable IR signal at the receiver. The raw capture will be output to the terminal program. Using the clipboard, it can be pasted to IrScrutinizer, and analyzed. Of course, also the other commands can be tested in this way.</p>
<h2>API</h2>
<p><a href="http://bengtmartensson.github.io/AGirs">Up-to-date API, generated by Doxygen</a>.</p>
<h2>Dependencies</h2>
<ul>
<li><a href="https://github.com/bengtmartensson/Infrared4Arduino"><code>Infrared4Arduino</code></a> by myself. Current version is 1.0.1. Can be installed by the library manager within the Arduino IDE. (Sketch -&gt; Include library -&gt; Manage libraries, name Infrared (Category: Others)).</li>
<li><code>Ethernet</code>, preferably version 2.0.0 or later.</li>
<li><code>SPI</code> (if enabling the <code>ETHERNET</code> or <code>LCD_I2C</code> configure option). Contained in the Arduino IDE.</li>
<li><code>Wire</code> (if enabling the <code>LCD_I2C</code> configure option). Contained in the Arduino IDE. If the preprocessor symbol <code>LCD</code> is defined in <code><a class="el" href="LedLcdManager_8cpp.html">src/GirsLib/LedLcdManager.cpp</a></code>, this is needed also if not actually using an LCD display.</li>
<li>(Optional) <a href="https://github.com/bengtmartensson/ABeacon"><code>Beacon</code></a> for an AMX compatible Ethernet beacon. It is also available in the Arduino library manager with the name <code>Beacon</code>.</li>
</ul>
<p>In previous versions, the library <a class="el" href="classLiquidCrystal__I2C.html">LiquidCrystal_I2C</a> was explicitly needed to be included. Currently, it has been integrated in the project (and slightly modified); see <code>src/GirsLib/LiquidCrystal_I2C_bm.[h|cpp]</code>.</p>
<h2>Questions and answers</h2>
<ul>
<li>How do I setup Lirc to use this?</li>
</ul>
<p>Use the <code>girs</code> driver contained in the recent official upstream Lirc distribution. This is described <a href="http://lirc.org/html/girs.html">here</a>. also contained in the (recent) distro as <code>girs.html</code>. Configuration options: use TRANSMIT if sending is desired, and RECEIVE if receiving is desired. CAPTURE is not meaningful for Lirc. Turn on PARAMETERS &ndash; Lircd adjust the ending timeout. If using DECODE and an LCD display (which is cool, but useless), be sure to define DONT_REPORT_DECODES. Use of Ethernet connections are supported. Due to the inner workings of Lirc, it is advantageous not define both TRANSMIT and RECEIVE unless you really need it.</p>
<ul>
<li>What are Makefiles doing in an Arduino project?</li>
</ul>
<p>To build the project for the Arduino, use the Arduino IDE from <a href="https://www.arduino.cc/en/Main/Software">arduino.cc</a>, as in most Arduino projects. The Makefile is used for maintainer work, like generating API documentation with Doxygen, as well as generating keywords.txt. It also generates scripts for Linux and Windows, that can be used for flashing the firmware to an Arduino Nano without deploying the Arduino IDE.</p>
<ul>
<li>What is the difference between <a href="http://www.harctoolbox.org/Glossary.html#ReceivingIrSignals">"receive"</a> and <a href="http://www.harctoolbox.org/Glossary.html#Capturing">"capture"</a>?</li>
</ul>
<p>Please follow the links given. Differently put, "receive" uses a demodulating receiver, "capture" a non-demodulating decoder. Note that this is not universally accepted terminology (yet!).</p>
<ul>
<li>What Ethernet modules are supported?</li>
</ul>
<p>Only cards based on the W5100, W5200, and W5500 chip (and compatible), like the <a href="https://www.arduino.cc/en/Main/ArduinoEthernetShield">official shield</a>. There are both cheap clones of the original available, as well as smallish W5100-based cards.</p>
<p>Also the next generation of W5500 based shields, like the official <a href="https://www.arduino.cc/en/Main/ArduinoEthernetShield">Arduino Ethernet Shield 2</a> work. For this, use the <code>Ethernet</code> library version 2.0.0 (or later).</p>
<ul>
<li>What about "GirsLite"?</li>
</ul>
<p>As indicated by the name, it is a minimalist Girs server for the Arduino, that implements only the <a href="http://www.harctoolbox.org/Girs.html#Capture">capture</a> and the <a href="http://www.harctoolbox.org/Girs.html#Transmit">transmit</a> modules, without all options. It is meant to be used with <a href="http://www.harctoolbox.org/IrScrutinizer.html">IrScrutinizer</a> versions 1.1.0 or later, as well as with Lirc, using the Lirc <code>girs</code> driver by yours truly. Documentation is found with the <a href="http://lirc.org/html/girs">Lirc driver</a>, in the Lirc sources the file <code>girs.html</code>.</p>
<p>It is not an independent program, it is just AGirs with certain options enabled, namely the CPP symbols <code>TRANSMIT, CAPTURE, LED</code>, and (optionally) <code>NON_MOD</code> defined. Alternatively, if <code>RECEIVE</code> is defined, but not <code>CAPTURE</code>, the program mimics the capture command with a demodulating sensor, for usage with IrScrutinizer without a non-demodulating sensor.</p>
<ul>
<li>Were did the <code>example/GirsLite</code> directory go?</li>
</ul>
<p>It has been merged with <code>examples/Girs</code>. To build GirsLite, make sure that <code>examples/config.h</code> is configured as you desire.</p>
<ul>
<li>What about Girs4Lirc?</li>
</ul>
<p><em>Now discontinued</em>, replaced by GirsLite. Just as GirsLite, this was just a certain configuration of AGirs, "optimized" for Lirc, supporting <code>TRANSMIT, NON_MOD</code> (optionally), <code>RECEIVE, LED, LCD, DECODE</code> (only to the LCD), <code>TRANSMITTERS</code> (only a dummy implementation).</p>
<ul>
<li>Can I keep and maintain the library configuration in another location, for example together with my own sketch?</li>
</ul>
<p>No, the present Arduino IDE does not support this. I an not aware of a clean solution. Sorry. Fiddling with the library's <code>config.h</code> for project specific configurations defeats the very idea of a library.</p>
<ul>
<li>How is "Girs" pronounced?</li>
</ul>
<p>It is pronounced like in "girl". The "language" Girs is written capitalized, the name of an implementation is usually written in lower case.</p>
<h2>License</h2>
<p>The entire work is licensed under the GPL2 "or later" license, just as Infrared4Arduino. Michael's code (that is contained in Infrared4Arduino) carries the GPL2-license, although he is <a href="http://www.hifi-remote.com/forums/viewtopic.php?p=112586#112586">willing to agree to "or later versions"</a>. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Apr 8 2022 21:58:49 for AGirs by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
